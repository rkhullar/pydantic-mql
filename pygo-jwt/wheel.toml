[tool.cibuildwheel]
environment = {GO_VERSION="1.21.8", ASDF_VERSION="0.14.0"}
skip = ["*-musllinux*"]

[tool.cibuildwheel.linux]
before-all = [
    "yum install -y make"
]
before-build = [
    "uname -a",
    "pip install pygo-tools",
    "./scripts/install-asdf-go.sh"
]
repair-wheel-command = "auditwheel repair --lib-sdir lib -w {dest_dir} {wheel}"

[[tool.cibuildwheel.overrides]]
select="*-????linux_*"
inherit.environment="append"
environment.ASDF_DIR = "/opt/asdf"

[[tool.cibuildwheel.overrides]]
select = "*-musllinux*"
before-all = [
    "apk add make",
]


# NOTES for Building:
# cibuildwheel --config-file wheel.toml --platform linux --archs x86_64,aarch64

# cibuildwheel --config-file wheel.toml --platform linux --arch x86_64
# cibuildwheel --config-file wheel.toml --platform linux --arch aarch64

# cibuildwheel --config-file wheel.toml --platform macos --arch x86_64
# cibuildwheel --config-file wheel.toml --platform macos --arch arm64
